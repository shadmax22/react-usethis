{"version":3,"file":"index.js","sources":["../src/core/managers/FunctionManager.tsx","../src/core/setter/setFun.ts","../src/core/setter/set.ts","../src/core/managers/EffectManager.tsx","../src/core/Reducers.tsx","../src/core/Dispatcher.tsx","../src/core/useThis/useThisInstance.tsx","../src/core/useThis/useThis.ts"],"sourcesContent":["type FunctionStore = {\n  [key: string]: Function;\n};\n\nconst function_collection: FunctionStore = {};\nlet functionIdCounter = 0;\n\nexport let FunctionManager = {\n  collection: {},\n} as {\n  collection: {\n    store: (func: Function) => string;\n    retrive: (id: string) => Function;\n    get: Object;\n  };\n  store: (obj: unknown) => unknown;\n  fetch: (obj: Object) => Object;\n};\n\nFunctionManager.collection.store = (func: Function) => {\n  const id = `__func_${functionIdCounter++}__`;\n  function_collection[id] = func;\n\n  return id;\n};\nFunctionManager.collection.retrive = (id: string) => {\n  return function_collection[id];\n};\nFunctionManager.collection.get = () => {\n  return function_collection;\n};\n\nFunctionManager.store = (obj: any): any => {\n  if (typeof obj === \"function\") {\n    return FunctionManager.collection.store(obj);\n  } else if (Array.isArray(obj)) {\n    return obj.map(FunctionManager.store);\n  } else if (obj !== null && typeof obj === \"object\") {\n    return Object.keys(obj).reduce((acc, key) => {\n      acc[key] = FunctionManager.store(obj[key]);\n      return acc;\n    }, {} as any);\n  }\n  return obj;\n};\n\nFunctionManager.fetch = (obj: Object): Object => {\n  if (\n    typeof obj === \"string\" &&\n    obj.startsWith(\"__func_\") &&\n    obj.endsWith(\"__\")\n  ) {\n    return FunctionManager.collection.retrive(obj);\n  } else if (Array.isArray(obj)) {\n    return obj.map(FunctionManager.fetch);\n  } else if (obj !== null && typeof obj === \"object\") {\n    return Object.keys(obj).reduce<{ [key: string]: Object }>((acc, key) => {\n      //@ts-ignore\n      acc[key] = FunctionManager.fetch(obj[key]);\n      return acc;\n    }, {});\n  }\n  return obj;\n};\n","import { set } from \"js-upsert\";\nimport { FunctionManager } from \"../managers/FunctionManager\";\n\nexport function setFun<T>(value: T) {\n  return set<T>(() => FunctionManager.store(value) as T);\n}\n","import { set as jsSet } from \"js-upsert\";\nimport { setFun } from \"./setFun\";\nimport { setType } from \"./setType\";\n\nexport const set: setType = jsSet as unknown as setType;\n\nset.fun = setFun;\n","import { useThis_Instance } from \"../useThis/useThisTypes\";\n\n/*\n\n\n  useThis-Effect\n\n  Idea: Execute a function on change of state\n\n  Initialization Flow:-\n\n  1. UseThis Dispatcher providing a reducer `EffectReducer` to useThis\n  2. On Initialisation of useThis(state_name) having a effect(effect_fun, dependent_state), effect is getting registered at a `effect_collection` \n  \n\n  Working Flow:-\n\n  All state dispatchers are having hook `executeEffects` to execute effect which is having dependency of current state. \n\n\n*/\nconst effect_collection: {\n  dependent_state: {\n    [state_id: string]: string[];\n  };\n  effects: {\n    [process_id: string]: Function;\n  };\n  registeredStates: { [state_name: string]: boolean };\n  registeredProcess: { [process_id: number]: string };\n  resolved: { [state_name: string]: boolean };\n  registeredDependency: { [state_name: string]: string[] };\n} = {\n  dependent_state: {},\n  effects: {},\n  registeredStates: {},\n  resolved: {},\n  registeredProcess: {},\n  registeredDependency: {},\n};\n\n/**\n *\n * @param props\n * @param props.state_name State name which is dispatching a effect fn\n * @param props.dependent_state_names Names of state which will execute effect fn on change\n * @param props.effect Effect Fn provided by user\n * @returns\n */\n\nexport function registerEffect(props: {\n  state_name: string;\n  effect: Function;\n  dependent_state_names: (string | useThis_Instance<unknown>)[];\n}) {\n  const { state_name, effect, dependent_state_names } = props;\n\n  if (\n    !Array.isArray(dependent_state_names) ||\n    dependent_state_names.length === 0\n  )\n    throw TypeError(\n      \"Second parameter of effect `dependent_states` must be a non-empty array.\"\n    );\n\n  // Check if state is already registered its effect or not\n\n  if (effect_collection.registeredStates?.[state_name]) return;\n\n  // Register a statename, to prevent re-rendering on next load\n\n  const process_id = state_name;\n\n  // Register proccess and state\n  effect_collection.registeredStates[state_name] = true;\n\n  // Iterate `dependent_state_names` and execute effects of each states\n\n  for (let dependent_state of dependent_state_names) {\n    if (\n      typeof dependent_state == \"function\" &&\n      //@ts-ignore\n      dependent_state?.[\"@___usethis\"] &&\n      dependent_state?.[\"this\"]\n    ) {\n      dependent_state = dependent_state[\"this\"];\n    }\n    if (typeof dependent_state === \"string\") {\n      // Verifing If dependent state registerd in collection or not, And appending new process_id to dependent_state\n\n      if (effect_collection.dependent_state?.[dependent_state]) {\n        effect_collection.dependent_state[dependent_state] = [\n          ...effect_collection.dependent_state[dependent_state],\n          process_id,\n        ];\n      } else {\n        effect_collection.dependent_state[dependent_state] = [process_id];\n      }\n\n      // Store decoded dependent state\n      effect_collection.registeredDependency[state_name] = [\n        ...(effect_collection.registeredDependency[state_name] ?? []),\n        dependent_state,\n      ];\n    } else {\n      throw TypeError(\n        \"Invalid type passed on `dependent_states`, Only string and useThis instance supported \"\n      );\n    }\n\n    // Storing effect fun in effects collection via process_id\n\n    effect_collection.effects[process_id] = effect;\n  }\n\n  // effect(() => deleteEffect({ state_name }));\n  // console.log(effect_collection);\n}\n\n/*\n  ExecuteEffects is a dispatch hook, whenver dispatch fired, executeEffects fired after it.\n  It re-executes fired-state's all assigned processes\n*/\nexport function executeEffects(state_name: string) {\n  // Check if state is having any assigned effects or not\n\n  if (effect_collection.dependent_state?.[state_name]) {\n    // Execute all assigned process\n    for (const process_id of effect_collection.dependent_state[state_name]) {\n      try {\n        //  Executing the process function associated with process_id and passing resolveEffect\n        effect_collection.effects[process_id](() =>\n          resolveEffect({\n            dependent_state_name: state_name, // State which is dependent to process_id\n            state_name: process_id,\n          })\n        );\n      } catch (e) {\n        // Handle the error\n      }\n    }\n  }\n}\nexport function resolveEffect(props: {\n  dependent_state_name: string;\n  state_name: string;\n}) {\n  const { dependent_state_name, state_name } = props;\n  effect_collection.dependent_state[dependent_state_name] =\n    effect_collection.dependent_state[dependent_state_name].filter(\n      (item) => item !== state_name\n    );\n\n  delete effect_collection.effects[state_name];\n\n  effect_collection.resolved[state_name] = true;\n}\nexport function deleteEffect(props: { state_name: string }) {\n  let { state_name } = props;\n\n  // Iterate all registered process and remove states from dependency\n  for (let dependent_state of effect_collection.registeredDependency[\n    state_name\n  ]) {\n    effect_collection.dependent_state[dependent_state] =\n      effect_collection.dependent_state[dependent_state].filter(\n        (state) => state !== state_name\n      );\n  }\n  delete effect_collection.effects[state_name];\n  effect_collection.resolved[state_name] = true;\n}\n\nexport function getEffects() {\n  return effect_collection;\n}\n","import { StateHandler } from \"../redux/slices/StateReducer\";\nimport _MAINSTORE, { StoreState } from \"../redux/store\";\nimport { useThisReturnType } from \"./useThis/useThisTypes\";\nimport { FunctionManager } from \"./managers/FunctionManager\";\n\n/*\n\n  These are reducers of useThis, for dispatching updating a state\n\n*/\n\nexport function Updater(StateName: keyof StoreState[\"This\"], dispatcher: any) {\n  return function update(data: any) {\n    let __DATA =\n      typeof data == \"function\"\n        ? data(_MAINSTORE.getState().This[StateName])\n        : data;\n\n    dispatcher(\n      StateHandler.update({\n        data: __DATA,\n        state: StateName,\n      })\n    );\n    return _MAINSTORE.getState().This[StateName];\n  };\n}\n\nexport function Appender(\n  StateName: keyof StoreState[\"This\"],\n  dispatcher: any\n): useThisReturnType<keyof StoreState[\"This\"]>[\"append\"] {\n  return function append(data) {\n    let __DATA =\n      typeof data == \"function\"\n        ? data(_MAINSTORE.getState().This[StateName])\n        : data;\n    dispatcher(\n      StateHandler.append({\n        data: __DATA,\n        state: StateName,\n      })\n    );\n    return _MAINSTORE.getState().This[StateName];\n  };\n}\n\nexport function Upsert(StateName: keyof StoreState[\"This\"], dispatcher: any) {\n  function updater(data: any) {\n    try {\n      dispatcher(\n        StateHandler.upsert({\n          data,\n          type: \"general\",\n          active_state: StateName,\n          config: {},\n        })\n      );\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  const upsert = (\n    ...data: any\n  ): useThisReturnType<keyof StoreState[\"This\"]>[\"upsert\"] => {\n    for (let i of data) {\n      updater(i);\n    }\n    return _MAINSTORE.getState().This[StateName];\n  };\n\n  upsert.at = (...keys: [...(string | number)[], unknown]) => {\n    dispatcher(\n      StateHandler.upsert({\n        data: keys,\n        active_state: StateName,\n        config: {},\n        type: \"at\",\n      })\n    );\n    return _MAINSTORE.getState().This[StateName];\n  };\n  upsert.funAt = (...keys: [...(string | number)[], void]) => {\n    const value = FunctionManager.store(keys[keys.length - 1]);\n\n    keys.pop();\n\n    const new_at_path = [...keys, value];\n    dispatcher(\n      StateHandler.upsert({\n        data: new_at_path,\n        active_state: StateName,\n        config: {},\n        type: \"at\",\n      })\n    );\n    return _MAINSTORE.getState().This[StateName];\n  };\n\n  return upsert;\n}\n","import { StateHandler } from \"../redux/slices/StateReducer\";\nimport _MAINSTORE, { StoreState } from \"../redux/store\";\nimport { useThisReturnType } from \"./useThis/useThisTypes\";\nimport { executeEffects, getEffects } from \"./managers/EffectManager\";\nimport { FunctionManager } from \"./managers/FunctionManager\";\nimport { Appender, Updater, Upsert } from \"./Reducers\";\n\nexport const useThisDispatcher = (StateName: string, defaultValue: any) => {\n  const redux_dispatcher = _MAINSTORE.dispatch;\n  const dispatcher = (param: any) => {\n    const r = redux_dispatcher(param);\n\n    // Execute all exisiting effects which is dependent on given state\n\n    executeEffects(StateName);\n    return r;\n  };\n  const requestedStateName = StateName as keyof StoreState[\"This\"];\n  const state_data = _MAINSTORE.getState()?.This;\n  if (\n    !state_data[requestedStateName] &&\n    defaultValue &&\n    !getEffects().resolved[requestedStateName]\n  ) {\n    dispatcher(\n      StateHandler.update({\n        data: defaultValue,\n        state: requestedStateName,\n      })\n    );\n  }\n\n  const useThisReturn = {\n    update: Updater(\n      requestedStateName,\n      dispatcher\n    ) as unknown as useThisReturnType<StoreState[\"This\"]>[\"update\"],\n    append: Appender(\n      requestedStateName,\n      dispatcher\n    ) as unknown as useThisReturnType<StoreState[\"This\"]>[\"append\"],\n    upsert: Upsert(\n      requestedStateName,\n      dispatcher\n    ) as unknown as useThisReturnType<StoreState[\"This\"]>[\"upsert\"],\n    dispatcher: dispatcher,\n    This: _MAINSTORE.getState().This[requestedStateName],\n    get: () =>\n      _MAINSTORE.getState().This[\n        requestedStateName\n      ] as unknown as useThisReturnType<StoreState[\"This\"]>[\"get\"],\n    fetch: () =>\n      FunctionManager.fetch(\n        _MAINSTORE.getState().This[requestedStateName]\n      ) as unknown as useThisReturnType<StoreState[\"This\"]>[\"fetch\"],\n  };\n\n  return useThisReturn as useThisReturnType<StoreState[\"This\"]>;\n};\nexport const useThisInstanceDispatcher = (StateName: string) => {\n  const redux_dispatcher = _MAINSTORE.dispatch;\n  const dispatcher = (param: any) => {\n    const r = redux_dispatcher(param);\n\n    // Execute all exisiting effects which is dependent on given state\n    executeEffects(StateName);\n    return r;\n  };\n  const requestedStateName = StateName as keyof StoreState[\"This\"];\n\n  const useThisReturn = {\n    update: Updater(\n      requestedStateName,\n      dispatcher\n    ) as unknown as useThisReturnType<StoreState[\"This\"]>[\"update\"],\n    append: Appender(\n      requestedStateName,\n      dispatcher\n    ) as unknown as useThisReturnType<StoreState[\"This\"]>[\"append\"],\n    upsert: Upsert(\n      requestedStateName,\n      dispatcher\n    ) as unknown as useThisReturnType<StoreState[\"This\"]>[\"upsert\"],\n    dispatcher: dispatcher,\n    This: _MAINSTORE.getState().This[requestedStateName],\n    get: () =>\n      _MAINSTORE.getState().This[\n        requestedStateName\n      ] as unknown as useThisReturnType<StoreState[\"This\"]>[\"get\"],\n    fetch: () =>\n      FunctionManager.fetch(\n        _MAINSTORE.getState().This[requestedStateName]\n      ) as unknown as useThisReturnType<StoreState[\"This\"]>[\"fetch\"],\n  };\n\n  return {\n    ...useThisReturn,\n  } as useThisReturnType<StoreState[\"This\"]>;\n};\n","import { useSelector } from \"react-redux\";\nimport { useThisDispatcher, useThisInstanceDispatcher } from \"../Dispatcher\";\nimport { registerEffect } from \"../managers/EffectManager\";\nimport { StateHandler } from \"../../redux/slices/StateReducer\";\nimport _MAINSTORE, { StoreState } from \"../../redux/store\";\nimport {\n  useThis_this_instance,\n  useThisInstanceType,\n  useThisReturnType,\n} from \"./useThisTypes\";\nexport function useThisInstanceReturn(prop1: unknown) {\n  const instance_data: useThis_this_instance = {\n    created: false,\n    stateName: \"state_\" + Math.floor(100000 + Math.random() * 900000),\n  };\n\n  if (prop1 && typeof prop1 == \"object\") {\n    instance_data.defaultData = prop1;\n  }\n\n  const useThisInstance = <T,>() => {\n    if (!instance_data.created) {\n      throw Error(\"Cannot use useThis Instance without created\");\n    }\n\n    return useThisInstanceFunction<T>(instance_data.stateName);\n  };\n\n  useThisInstance[\"@___usethis\"] = __APP_VERSION__;\n  useThisInstance[\"this\"] = instance_data.stateName;\n\n  useThisInstance.onEffect = (resolver: any, dependent_states: any) => {\n    instance_data[\"onEffect\"] = {\n      resolver,\n      dependent_states,\n    };\n\n    return useThisInstance;\n  };\n  useThisInstance.stateName = (state_name: string) => {\n    instance_data[\"stateName\"] = state_name;\n\n    return useThisInstance;\n  };\n  useThisInstance.default = <T extends object>(object: T) => {\n    instance_data[\"defaultData\"] = object;\n\n    return useThisInstance as () => ReturnType<\n      typeof useThisInstanceFunction<T>\n    >;\n  };\n\n  useThisInstance.setConfig = <T extends keyof useThis_this_instance>(\n    config_name: T,\n    value: useThis_this_instance[T]\n  ) => {\n    instance_data[config_name] = value;\n    return useThisInstance;\n  };\n\n  useThisInstance.use = {};\n\n  useThisInstance.create = () => {\n    if (instance_data.created) return;\n    useThisInstance[\"this\"] = instance_data.stateName;\n\n    if (instance_data.defaultData) {\n      _MAINSTORE.dispatch(\n        StateHandler.update({\n          data: instance_data.defaultData,\n          state: instance_data.stateName,\n        })\n      );\n    }\n\n    if (instance_data.onEffect) {\n      registerEffect({\n        state_name: instance_data.stateName,\n        dependent_state_names: instance_data.onEffect.dependent_states ?? [],\n\n        // Effect is stored in effect_collection.effects.{process_id}, This will execute on effect condtion\n\n        effect: (effectResolver: Function) =>\n          instance_data.onEffect?.resolver({\n            thisState: _MAINSTORE.getState().This,\n            state: (\n              state_name:\n                | keyof StoreState[\"This\"]\n                | (Function & {\n                    this: keyof StoreState[\"This\"];\n                    \"@___usethis\": unknown;\n                  })\n            ) => {\n              if (typeof state_name == \"function\" && state_name[\"@___usethis\"])\n                return _MAINSTORE.getState().This[state_name.this];\n              return _MAINSTORE.getState().This[\n                state_name as keyof StoreState[\"This\"]\n              ];\n            },\n            resolver: () => {\n              _MAINSTORE.dispatch(\n                StateHandler.removeState({\n                  active_state: instance_data.stateName,\n                })\n              );\n              effectResolver();\n\n              // instance_data.created = false;\n            },\n          }),\n      });\n    }\n\n    instance_data.created = true;\n\n    useThisInstance.use = {\n      ...(useThisDispatcher(\n        instance_data[\"stateName\"],\n        instance_data[\"defaultData\"]\n      ) as unknown as useThisReturnType<(typeof instance_data)[\"defaultData\"]>),\n    } as any;\n\n    return useThisInstance;\n  };\n\n  return useThisInstance;\n}\n\nfunction useThisInstanceFunction<DefaultValue>(\n  StateName: string\n): useThisInstanceType<DefaultValue> {\n  try {\n    useSelector((s: any) => s.This?.[StateName]);\n  } catch (e) {}\n\n  return useThisInstanceDispatcher(\n    StateName\n  ) as unknown as useThisInstanceType<DefaultValue>;\n}\n","import { useSelector } from \"react-redux\";\nimport { useThisDispatcher } from \"../Dispatcher\";\nimport { useThisInstanceReturn } from \"./useThisInstance\";\nimport { useThisReturnType, useThisType } from \"./useThisTypes\";\n\nfunction useThisMainFunction<DefaultValue>(\n  StateName: string,\n  defaultValue?: DefaultValue\n): useThisReturnType<DefaultValue> {\n  try {\n    useSelector((s: any) => s.This?.[StateName]);\n  } catch (e) {}\n\n  return useThisDispatcher(\n    StateName,\n    defaultValue\n  ) as unknown as useThisReturnType<DefaultValue>;\n}\n\nfunction useThisBuilder(prop1: unknown, prop2: unknown) {\n  // Handling new Instance\n  if (new.target) {\n    return useThisInstanceReturn(prop1);\n  }\n\n  // Rtn useThis as it is\n  return useThisMainFunction(prop1 as string, prop2);\n}\n\nexport const useThis: useThisType = useThisBuilder as unknown as useThisType;\n"],"names":["function_collection","functionIdCounter","FunctionManager","func","id","obj","acc","key","setFun","value","set","jsSet","effect_collection","registerEffect","props","state_name","effect","dependent_state_names","_a","process_id","dependent_state","_b","executeEffects","resolveEffect","dependent_state_name","item","getEffects","Updater","StateName","dispatcher","data","__DATA","_MAINSTORE","StateHandler","Appender","Upsert","updater","e","upsert","i","keys","new_at_path","useThisDispatcher","defaultValue","redux_dispatcher","param","r","requestedStateName","useThisInstanceDispatcher","useThisInstanceReturn","prop1","instance_data","useThisInstance","useThisInstanceFunction","resolver","dependent_states","object","config_name","effectResolver","useSelector","s","useThisMainFunction","useThisBuilder","prop2","useThis"],"mappings":"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"}