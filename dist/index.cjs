"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const a=require("./ThisProvider-DB1tIHGQ.cjs");require("react");const d={};let y=0,o={collection:{}};o.collection.store=e=>{const t=`__func_${y++}__`;return d[t]=e,t};o.collection.retrive=e=>d[e];o.collection.get=()=>d;o.store=e=>typeof e=="function"?o.collection.store(e):Array.isArray(e)?e.map(o.store):e!==null&&typeof e=="object"?Object.keys(e).reduce((t,n)=>(t[n]=o.store(e[n]),t),{}):e;o.fetch=e=>typeof e=="string"&&e.startsWith("__func_")&&e.endsWith("__")?o.collection.retrive(e):Array.isArray(e)?e.map(o.fetch):e!==null&&typeof e=="object"?Object.keys(e).reduce((t,n)=>(t[n]=o.fetch(e[n]),t),{}):e;function h(e){return a.c(()=>o.store(e))}const _=a.c;_.fun=h;const c={dependent_state:{},effects:{},registeredStates:{},resolved:{},registeredProcess:{},registeredDependency:{}};function I(e){var u,f;const{state_name:t,effect:n,dependent_state_names:r}=e;if(!Array.isArray(r)||r.length===0)throw TypeError("Second parameter of effect `dependent_states` must be a non-empty array.");if((u=c.registeredStates)!=null&&u[t])return;const s=t;c.registeredStates[t]=!0;for(let i of r){if(typeof i=="function"&&(i!=null&&i["@___usethis"])&&(i!=null&&i.this)&&(i=i.this),typeof i=="string")(f=c.dependent_state)!=null&&f[i]?c.dependent_state[i]=[...c.dependent_state[i],s]:c.dependent_state[i]=[s],c.registeredDependency[t]=[...c.registeredDependency[t]??[],i];else throw TypeError("Invalid type passed on `dependent_states`, Only string and useThis instance supported ");c.effects[s]=n}}function p(e){var t;if((t=c.dependent_state)!=null&&t[e])for(const n of c.dependent_state[e])try{c.effects[n](()=>M({dependent_state_name:e,state_name:n}))}catch{}}function M(e){const{dependent_state_name:t,state_name:n}=e;c.dependent_state[t]=c.dependent_state[t].filter(r=>r!==n),delete c.effects[n],c.resolved[n]=!0}function R(){return c}function l(e,t){return function(r){let s=typeof r=="function"?r(a._MAINSTORE.getState().This[e]):r;return t(a.StateHandler.update({data:s,state:e})),a._MAINSTORE.getState().This[e]}}function T(e,t){return function(r){let s=typeof r=="function"?r(a._MAINSTORE.getState().This[e]):r;return t(a.StateHandler.append({data:s,state:e})),a._MAINSTORE.getState().This[e]}}function S(e,t){function n(s){try{t(a.StateHandler.upsert({data:s,type:"general",active_state:e,config:{}}))}catch(u){console.log(u)}}const r=(...s)=>{for(let u of s)n(u);return a._MAINSTORE.getState().This[e]};return r.at=(...s)=>(t(a.StateHandler.upsert({data:s,active_state:e,config:{},type:"at"})),a._MAINSTORE.getState().This[e]),r.funAt=(...s)=>{const u=o.store(s[s.length-1]);s.pop();const f=[...s,u];return t(a.StateHandler.upsert({data:f,active_state:e,config:{},type:"at"})),a._MAINSTORE.getState().This[e]},r}const g=(e,t)=>{var i;const n=a._MAINSTORE.dispatch,r=A=>{const E=n(A);return p(e),E},s=e;return!((i=a._MAINSTORE.getState())==null?void 0:i.This)[s]&&t&&!R().resolved[s]&&r(a.StateHandler.update({data:t,state:s})),{update:l(s,r),append:T(s,r),upsert:S(s,r),dispatcher:r,This:a._MAINSTORE.getState().This[s],get:()=>a._MAINSTORE.getState().This[s],fetch:()=>o.fetch(a._MAINSTORE.getState().This[s])}},O=e=>{const t=a._MAINSTORE.dispatch,n=u=>{const f=t(u);return p(e),f},r=e;return{...{update:l(r,n),append:T(r,n),upsert:S(r,n),dispatcher:n,This:a._MAINSTORE.getState().This[r],get:()=>a._MAINSTORE.getState().This[r],fetch:()=>o.fetch(a._MAINSTORE.getState().This[r])}}};function N(e){const t={created:!1,stateName:"state_"+Math.floor(1e5+Math.random()*9e5)};e&&typeof e=="object"&&(t.defaultData=e);const n=()=>{if(!t.created)throw Error("Cannot use useThis Instance without created");return v(t.stateName)};return n["@___usethis"]="0.1.6862",n.this=t.stateName,n.onEffect=(r,s)=>(t.onEffect={resolver:r,dependent_states:s},n),n.stateName=r=>(t.stateName=r,n),n.default=r=>(t.defaultData=r,n),n.setConfig=(r,s)=>(t[r]=s,n),n.use={},n.create=()=>{if(!t.created)return n.this=t.stateName,t.defaultData&&a._MAINSTORE.dispatch(a.StateHandler.update({data:t.defaultData,state:t.stateName})),t.onEffect&&I({state_name:t.stateName,dependent_state_names:t.onEffect.dependent_states??[],effect:r=>{var s;return(s=t.onEffect)==null?void 0:s.resolver({thisState:a._MAINSTORE.getState().This,state:u=>typeof u=="function"&&u["@___usethis"]?a._MAINSTORE.getState().This[u.this]:a._MAINSTORE.getState().This[u],resolver:()=>{a._MAINSTORE.dispatch(a.StateHandler.removeState({active_state:t.stateName})),r()}})}}),t.created=!0,n.use={...g(t.stateName,t.defaultData)},n},n}function v(e){try{a.useSelector(t=>{var n;return(n=t.This)==null?void 0:n[e]})}catch{}return O(e)}function D(e,t){try{a.useSelector(n=>{var r;return(r=n.This)==null?void 0:r[e]})}catch{}return g(e,t)}function m(e,t){return new.target?N(e):D(e,t)}const H=m;exports.ThisProvider=a.ThisProvider;exports.set=_;exports.setFun=h;exports.useThis=H;
//# sourceMappingURL=index.cjs.map
