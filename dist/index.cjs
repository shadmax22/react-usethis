"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const a=require("./store-Bg4MK4Fz.cjs"),d={};let y=0,o={collection:{}};o.collection.store=e=>{const t=`__func_${y++}__`;return d[t]=e,t};o.collection.retrive=e=>d[e];o.collection.get=()=>d;o.store=e=>typeof e=="function"?o.collection.store(e):Array.isArray(e)?e.map(o.store):e!==null&&typeof e=="object"?Object.keys(e).reduce((t,n)=>(t[n]=o.store(e[n]),t),{}):e;o.fetch=e=>typeof e=="string"&&e.startsWith("__func_")&&e.endsWith("__")?o.collection.retrive(e):Array.isArray(e)?e.map(o.fetch):e!==null&&typeof e=="object"?Object.keys(e).reduce((t,n)=>(t[n]=o.fetch(e[n]),t),{}):e;function _(e){return a.c(()=>o.store(e))}const h=a.c;h.fun=_;const i={dependent_state:{},effects:{},registeredStates:{},resolved:{},registeredProcess:{},registeredDependency:{}};function I(e){var u,f;const{state_name:t,effect:n,dependent_state_names:s}=e;if(!Array.isArray(s)||s.length===0)throw TypeError("Second parameter of effect `dependent_states` must be a non-empty array.");if((u=i.registeredStates)!=null&&u[t])return;const r=t;i.registeredStates[t]=!0;for(let c of s){if(typeof c=="function"&&(c!=null&&c["@___usethis"])&&(c!=null&&c.this)&&(c=c.this),typeof c=="string")(f=i.dependent_state)!=null&&f[c]?i.dependent_state[c]=[...i.dependent_state[c],r]:i.dependent_state[c]=[r],i.registeredDependency[t]=[...i.registeredDependency[t]??[],c];else throw TypeError("Invalid type passed on `dependent_states`, Only string and useThis instance supported ");i.effects[r]=n}}function p(e){var t;if((t=i.dependent_state)!=null&&t[e])for(const n of i.dependent_state[e])try{i.effects[n](()=>M({dependent_state_name:e,state_name:n}))}catch{}}function M(e){const{dependent_state_name:t,state_name:n}=e;i.dependent_state[t]=i.dependent_state[t].filter(s=>s!==n),delete i.effects[n],i.resolved[n]=!0}function R(){return i}function l(e,t){return function(s){let r=typeof s=="function"?s(a._MAINSTORE.getState().This[e]):s;return t(a.StateHandler.update({data:r,state:e})),a._MAINSTORE.getState().This[e]}}function T(e,t){return function(s){let r=typeof s=="function"?s(a._MAINSTORE.getState().This[e]):s;return t(a.StateHandler.append({data:r,state:e})),a._MAINSTORE.getState().This[e]}}function S(e,t){function n(r){try{t(a.StateHandler.upsert({data:r,type:"general",active_state:e,config:{}}))}catch(u){console.log(u)}}const s=(...r)=>{for(let u of r)n(u);return a._MAINSTORE.getState().This[e]};return s.at=(...r)=>(t(a.StateHandler.upsert({data:r,active_state:e,config:{},type:"at"})),a._MAINSTORE.getState().This[e]),s.funAt=(...r)=>{const u=o.store(r[r.length-1]);r.pop();const f=[...r,u];return t(a.StateHandler.upsert({data:f,active_state:e,config:{},type:"at"})),a._MAINSTORE.getState().This[e]},s}const g=(e,t)=>{var c;const n=a._MAINSTORE.dispatch,s=A=>{const E=n(A);return p(e),E},r=e;return!((c=a._MAINSTORE.getState())==null?void 0:c.This)[r]&&t&&!R().resolved[r]&&s(a.StateHandler.update({data:t,state:r})),{update:l(r,s),append:T(r,s),upsert:S(r,s),dispatcher:s,This:a._MAINSTORE.getState().This[r],get:()=>a._MAINSTORE.getState().This[r],fetch:()=>o.fetch(a._MAINSTORE.getState().This[r])}},O=e=>{const t=a._MAINSTORE.dispatch,n=u=>{const f=t(u);return p(e),f},s=e;return{...{update:l(s,n),append:T(s,n),upsert:S(s,n),dispatcher:n,This:a._MAINSTORE.getState().This[s],get:()=>a._MAINSTORE.getState().This[s],fetch:()=>o.fetch(a._MAINSTORE.getState().This[s])}}};function N(e){const t={created:!1,stateName:"state_"+Math.floor(1e5+Math.random()*9e5)};e&&typeof e=="object"&&(t.defaultData=e);const n=()=>{if(!t.created)throw Error("Cannot use useThis Instance without created");return v(t.stateName)};return n["@___usethis"]="0.1.53",n.this=t.stateName,n.onEffect=(s,r)=>(t.onEffect={resolver:s,dependent_states:r},n),n.stateName=s=>(t.stateName=s,n),n.default=s=>(t.defaultData=s,n),n.setConfig=(s,r)=>(t[s]=r,n),n.use={},n.create=()=>{if(!t.created)return n.this=t.stateName,t.defaultData&&a._MAINSTORE.dispatch(a.StateHandler.update({data:t.defaultData,state:t.stateName})),t.onEffect&&I({state_name:t.stateName,dependent_state_names:t.onEffect.dependent_states??[],effect:s=>{var r;return(r=t.onEffect)==null?void 0:r.resolver({thisState:a._MAINSTORE.getState().This,state:u=>typeof u=="function"&&u["@___usethis"]?a._MAINSTORE.getState().This[u.this]:a._MAINSTORE.getState().This[u],resolver:()=>{a._MAINSTORE.dispatch(a.StateHandler.removeState({active_state:t.stateName})),s()}})}}),t.created=!0,n.use={...g(t.stateName,t.defaultData)},n},n}function v(e){try{a.useSelector(t=>{var n;return(n=t.This)==null?void 0:n[e]})}catch{}return O(e)}function D(e,t){try{a.useSelector(n=>{var s;return(s=n.This)==null?void 0:s[e]})}catch{}return g(e,t)}function m(e,t){return new.target?N(e):D(e,t)}const H=m;exports.set=h;exports.setFun=_;exports.useThis=H;
//# sourceMappingURL=index.cjs.map
